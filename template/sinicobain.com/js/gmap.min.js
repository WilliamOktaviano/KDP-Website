function GMap(e){var o,t=this,a=e.mapObj,n=e.autocompleteObj,l=e.latlngObj,i=e.currentLocObj,r=(e.mapOptions,[]),c=new google.maps.LatLngBounds,s=new google.maps.DirectionsService,g=new google.maps.DirectionsRenderer;new google.maps.Size(71,71),new google.maps.Point(0,0),new google.maps.Point(17,34),new google.maps.Size(25,25);this.setMapPoint=function(e){var a="",l=!1,i=0,s=0;e.latlng?(i=(a=e.latlng).lat,s=a.lng):(l=!0,place=e.place,a=place.geometry.location,i=place.geometry.location.lat(),s=place.geometry.location.lng());var g=new google.maps.Marker({map:o,icon:null,title:"",draggable:!0,position:a});r.push(g),t.updateLatLngValue(i,s),o.panTo(a),google.maps.event.addListener(g,"dragend",function(e){n.val("");var a=e.latLng.lat(),l=e.latLng.lng();t.updateLatLngValue(a,l),o.panTo(new google.maps.LatLng(a,l)),t.updateFromGeoDecode(a,l)}),l&&(place.geometry.viewport?c.union(place.geometry.viewport):c.extend(place.geometry.location))},this.updateFromGeoDecode=function(e,o){if(n){var t={lat:parseFloat(e),lng:parseFloat(o)};(new google.maps.Geocoder).geocode({location:t}).then(function(e){e.results[0]?n.val(e.results[0].formatted_address):n.val("")}).catch(function(e){})}},this.updateLatLngValue=function(e,o){l&&l.val(e+","+o)},this.setCurrentLocation=function(){t.clearAllMarkers(),navigator.geolocation.getCurrentPosition(function(e){var o={lat:e.coords.latitude,lng:e.coords.longitude};t.setMapPoint({latlng:o}),t.updateFromGeoDecode(o.lat,o.lng)})},this.clearAllMarkers=function(){r.forEach(function(e){e.setMap(null)}),r=[]},this.initAutocomplete=function(){var e=-6.1769694,a=106.8252319;o=this.createMapObj({lat:e,lng:a});var r=l?l.val():"";if(r&&""!=r){var s=r.split(",");e=parseFloat(s[0]),a=parseFloat(s[1]),initialLocation=new google.maps.LatLng(e,a),t.setMapPoint({latlng:initialLocation})}else navigator.geolocation&&t.setCurrentLocation();if(n){var g=n[0],p=new google.maps.places.SearchBox(g);p.addListener("places_changed",function(){var e=p.getPlaces();0!=e.length&&(t.clearAllMarkers(),c=new google.maps.LatLngBounds,e.forEach(function(e){e.geometry&&e.geometry.location?t.setMapPoint({place:e}):console.log("Returned place contains no geometry")}),o.fitBounds(c))}),o.addListener("bounds_changed",function(){p.setBounds(o.getBounds())})}i&&i.on("click",function(){t.setCurrentLocation()})},this.calcRoute=function(e,o,t){e.panTo(o);var a={origin:o,destination:t,travelMode:"DRIVING"};s.route(a,function(e,o){"OK"==o&&g.setDirections(e)})},this.createMapObj=function(e,o){e||(e={lat:-6.1769694,lng:106.8252319});var t={center:e,zoom:17,mapTypeId:"roadmap",styles:[{featureType:"poi",stylers:[{visibility:"off"}]}]},n=$.extend({},t,o),l=new google.maps.Map(a[0],n);return g.setMap(l),l}}