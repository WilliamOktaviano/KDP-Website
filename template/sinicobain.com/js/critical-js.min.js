function preventSubmitBeforeJSLoaded(e){event.preventDefault(),alert("Please wait until the web fully loaded.")}function addEventListenerByClass(e,a,t){for(var n=document.getElementsByClassName(e),i=0,l=n.length;i<l;i++)n[i].addEventListener(a,t,!1)}function removeEventListenerByClass(e,a,t){for(var n=document.getElementsByClassName(e),i=0,l=n.length;i<l;i++)n[i].removeEventListener(a,t,!1)}function hideOverlayScreen(){$("html, body").css("overflow","inherit"),$("#popup-panel").fadeOut("fast")}function loadOverlayScreen(e){$(":focus").blur(),$("html, body").css("overflow","hidden"),$("#popup-panel").fadeIn("fast"),e.url&&$("#popup-panel").load(e.url),$("#popup-panel").on("click",function(e){$(e.target).hasClass("content-panel")||$(e.target).closest(".content-panel").length||hideOverlayScreen()})}function createImageUploader(e,a,t){var n=$("."+e.name);void 0!=a.token&&""!=a.token||(a.token=Math.floor(1e3*Math.random()+1).toString()+$.now()),n.append('<input type="hidden" name="'+e.name+'" />'),n.append('<input type="hidden" name="token-'+e.name+'" value="'+a.token+'" />');var i=e.btnLabel?e.btnLabel:"Upload File";new qq.FileUploader({element:n.find(".file-uploader")[0],action:"/fileuploader.php?action=upload&folder="+a.folder+"&token="+a.token,allowedExtensions:["jpg","jpeg","png","gif","ico"],template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">'+i+'</div><ul class="qq-upload-list"></ul></div>',onComplete:function(n,i,l){1==l.success&&pushImageThumb(e,{folder:a.folder,token:a.token,fileName:l.fileName,phpThumbHash:l.phpThumbHash},t)}});return a.token}function pushImageThumb(e,a,t){var n=PHP_CONFIG.uploadTempDocShort,i=$("."+e.name);0==t&&i.find(".image-list").html("");var l=a.fileName.substr(a.fileName.lastIndexOf(".")+1);fileurl="../phpthumb/phpThumb.php?src="+n+a.folder+a.token+"/"+a.fileName+"&w=150&h=150&far=C&hash="+a.phpThumbHash,"ico"==l&&(fileurl=PHP_CONFIG.uploadTempURL+a.folder+a.token+"/"+a.fileName);var o='<li relfilename="'+a.fileName+'" relPHPThumbHash="'+a.phpThumbHash+'">';o+='<div class="file-uploader-image"><img src="'+fileurl+'"/></div>',o+="</li>",i.find(".image-list").append(o),updateItemImageArray(e,a.token),i.find(".image-list li:last img").on("load",function(){$(this).closest(".file-uploader-image").css("background-image","none")})}function updateItemImageArray(e,a){var t=$("."+e.name);uploadedImage[a]=Array(),t.find(".image-list li").each(function(e){uploadedImage[a].push($(this).attr("relfilename"))}),t.find("[name="+e.name+"]").val(uploadedImage[a])}function createFileUploader(e,a,t,n,i){var l=$("."+e);if(void 0!=t&&""!=t||(t=Math.floor(1e3*Math.random()+1).toString()+$.now()),uploadedFile[t]=Array(),l.append('<input type="hidden" name="'+e+'" />'),l.append('<input type="hidden" name="token-'+e+'" value="'+t+'" />'),void 0!=n||""==n){var o;for(o=0;o<n.length;o++)pushFileThumb(e,a,t,n[o],i)}new qq.FileUploader({element:l.find(".file-uploader")[0],action:"/fileuploader.php?action=upload&isfile=1&folder="+a+"&token="+t,onComplete:function(n,l,o){1==o.success&&pushFileThumb(e,a,t,o.fileName,i)}});return t}function pushFileThumb(e,a,t,n,i){var l=$("."+e),o=(n.substr(n.lastIndexOf(".")+1).toLowerCase(),'<li relfilename="'+n+'" >');o+='<div class="panel">',o+='<div class="file-uploader-description"><a href="/download.php?filename='+a+t+"/"+n+'" target="_blank" title="'+n+'">'+n+"</a></div>",o+='<div class="delete-icon" onClick="deleteFileUploaderThumb(this,\''+e+"','"+t+'\')"><i class="fas fa-times"></i></div>',o+='<div style="clear:both;"></div>',o+="</div>",o+="</li>",0==i&&l.find(".file-list").html(""),l.find(".file-list").append(o),updateItemFileArray(e,t),l.find(".file-list li:last img").on("load",function(){$(this).closest(".file-uploader-image").css("background-image","none")})}function updateItemFileArray(e,a){var t=$("."+e);uploadedFile[a]=Array(),$(" ."+e+" .file-list li").each(function(e){uploadedFile[a].push($(this).attr("relfilename"))}),t.find("[name="+e+"]").val(uploadedFile[a])}function deleteFileUploaderThumb(e,a,t){$(e).closest("li").remove(),updateItemFileArray(a,t)}function loadSubMenuProfile(){$(".subsec-profile").hover(function(){$(this).find(".profile-sub-menu").fadeIn("fast")},function(){$(this).find(".profile-sub-menu").fadeOut("fast")})}function disableButton(e,a){void 0==a&&(a=!0),e.prop("disabled",a),a?e.find(".loading-icon:first").show():e.find(".loading-icon:first").hide()}function setStatusColorNotification(e,a){switch(a){case 1:e.removeClass("bg-green-avocado").addClass("bg-red-salmon show");break;case 2:e.removeClass("bg-red-salmon").addClass("bg-green-avocado show")}}function inputNumberOnBlur(e,a){if(""==e.val()||!$.isNumeric(unformatCurrency(e.val()))){e.val(0);try{$(e).closest("form").bootstrapValidator("revalidateField",$(e).attr("name"))}catch(e){}}void 0==a&&(a=0),e.formatCurrency({roundToDecimalPlace:a})}function inputNumberOnFocus(e){e.prop("readonly")||e.prop("disabled")||0!=e.val()&&$.isNumeric(unformatCurrency(e.val()))||e.val("")}function unformatCurrency(e){return void 0==e?0:e.replace(/,/g,"")}function removeDetailRows(obj,alwaysDeleteRow){var transactionTable=$(obj).closest(".transaction-detail");$listRow=transactionTable.find(">.transaction-detail-row");var detailRow=$(obj).closest(".transaction-detail-row");$listRow.length<=1&&!alwaysDeleteRow?(detailRow.find("input").not(obj).val("").blur(),detailRow.find("textarea").html(""),detailRow.find("select").prop("selectedIndex",0),detailRow.find(".image-panel").css("background-image","")):detailRow.remove(),updateRowNumber(transactionTable);var handler=$(obj).attr("attrhandler");void 0!=handler&&eval(handler)}function updateRowNumber(e){var a=1;e.find(".row-number").each(function(){$(this).html(a+"."),a++})}function addNewTemplateRow(e,a,t,n,i){var l=$("#defaultForm").find("[name='detailRowsToken[]']:enabled"),o=".transaction-detail",d="transaction-detail-row",r=t?t.find("."+e):$("#defaultForm ."+e),s=r.clone().removeClass(e).removeClass("row-template").addClass(d);if(i?s.insertAfter(i):s.insertBefore(r.first()),s.show(),void 0!=a&&a.length>0){var u,f=JSON.parse(a);for(u=0;u<f.length;u++)"string"===jQuery.type(f[u].value)&&(f[u].value=decodeHTMLEntities(f[u].value)),s.find('[name="'+f[u].selector+'[]"]').val(f[u].value)}s.find(".inputnumber").bind("blur",function(e){inputNumberOnBlur($(this))}),s.find(".inputdecimal").bind("blur",function(e){inputNumberOnBlur($(this),2)}),s.find(".inputautodecimal").bind("blur",function(e){inputNumberOnBlur($(this),-2)}),s.find(".inputnumber, .inputdecimal, .inputautodecimal").bind("focus",function(e){inputNumberOnFocus($(this))}),s.find("input, select, textarea").removeAttr("disabled tabIndex"),s.find(".no-tabs-index, input[readonly], select[readonly], textarea[readonly]").attr("tabIndex","-1"),s.find(".row-template").find("input, select, textarea").attr("disabled",!0).attr("tabIndex","-1"),s.find(".ckeditor").each(function(){var e=(new Date).getTime()+Math.floor(99999*Math.random()+1);$(this).attr("id",e),$("#"+e).ckeditor()}),s.find(".btn-more-options").bind("click",function(e){mnvOptionsRowOnClick($(this))}),s.find(".mnv-barcode-input").keydown(function(e){barcodeHandler(this,e)});f=l.last().val();token=f?parseInt(f)+1:1,s.find("[name='detailRowsToken[]']").val(token);var p=s.find(".options-row .form-panel").find("input, select, textarea");return p.addClass("label-style"),p.bind("focusout",function(e){$(this).addClass("label-style")}).bind("focus",function(e){$(this).removeClass("label-style")}),s.find(".remove-button").bind("click",function(e){removeDetailRows(this)}),s.find(".add-row-button").unbind("click").bind("click",function(e){$row=addNewTemplateRow($(this).attr("attr-template"),null,$(this).closest(o),n,$(this).closest("."+d))}),updateRowNumber(s.closest(o)),n&&n(),s}var uploadedImage={},uploadedFile={};addEventListenerByClass("prevent-form-submit","submit",preventSubmitBeforeJSLoaded);